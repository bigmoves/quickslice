<!doctype html>
<html><head><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1.0" name="viewport"><title>quickslice - Blobs</title><link href="/styles.css" rel="stylesheet"></head><body><button aria-label="Toggle menu" class="menu-toggle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line xmlns="http://www.w3.org/2000/svg" x1="3" x2="21" y1="6" y2="6"></line><line xmlns="http://www.w3.org/2000/svg" x1="3" x2="21" y1="12" y2="12"></line><line xmlns="http://www.w3.org/2000/svg" x1="3" x2="21" y1="18" y2="18"></line></svg></button><div class="sidebar-backdrop"></div><div class="container"><aside class="sidebar"><div class="sidebar-brand"><svg xmlns="http://www.w3.org/2000/svg" class="sidebar-logo" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><defs xmlns="http://www.w3.org/2000/svg"><linearGradient xmlns="http://www.w3.org/2000/svg" id="board1" x1="0%" x2="100%" y1="0%" y2="100%"><stop xmlns="http://www.w3.org/2000/svg" offset="0%" stop-color="#FF6347" stop-opacity="1"></stop><stop xmlns="http://www.w3.org/2000/svg" offset="100%" stop-color="#FF4500" stop-opacity="1"></stop></linearGradient><linearGradient xmlns="http://www.w3.org/2000/svg" id="board2" x1="0%" x2="100%" y1="0%" y2="100%"><stop xmlns="http://www.w3.org/2000/svg" offset="0%" stop-color="#00CED1" stop-opacity="1"></stop><stop xmlns="http://www.w3.org/2000/svg" offset="100%" stop-color="#4682B4" stop-opacity="1"></stop></linearGradient></defs><g xmlns="http://www.w3.org/2000/svg" transform="translate(64, 64)"><ellipse xmlns="http://www.w3.org/2000/svg" cx="0" cy="-28" fill="url(#board1)" rx="50" ry="20"></ellipse><ellipse xmlns="http://www.w3.org/2000/svg" cx="0" cy="0" fill="url(#board2)" rx="60" ry="20"></ellipse><ellipse xmlns="http://www.w3.org/2000/svg" cx="0" cy="28" fill="#32CD32" rx="40" ry="20"></ellipse></g></svg><span class="sidebar-title">quickslice</span></div><nav><ul><li><a href="/">Getting Started</a></li><li><a href="/authentication">Authentication</a></li><li><a href="/queries">Queries</a></li><li><a href="/mutations">Mutations</a></li><li><a href="/joins">Joins</a></li><li><a href="/aggregations">Aggregations</a></li><li><a href="/subscriptions">Subscriptions</a></li><li><a class="active" href="/blobs">Blobs</a></li><li><a href="/variables">Variables</a></li><li><a href="/deployment">Deployment</a></li><li><a href="/mcp">MCP</a></li></ul></nav></aside><main class="content"><div><h1 id="Working-with-Blobs">Working with Blobs</h1>
<p>Blobs are used for binary data like images, videos, and files. They are uploaded separately and referenced by their CID (Content Identifier).</p>
<h2 id="Upload-Blob">Upload Blob</h2>
<p>Upload binary data encoded as base64:</p>
<pre><code class="language-graphql">mutation {
  uploadBlob(
    data: &quot;iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAY...&quot;
    mimeType: &quot;image/png&quot;
  ) {
    ref
    mimeType
    size
  }
}
</code></pre>
<p>Response:</p>
<pre><code class="language-json">{
  &quot;data&quot;: {
    &quot;uploadBlob&quot;: {
      &quot;ref&quot;: &quot;bafkreiabc123xyz...&quot;,
      &quot;mimeType&quot;: &quot;image/png&quot;,
      &quot;size&quot;: 1024
    }
  }
}
</code></pre>
<h2 id="Blob-Reference">Blob Reference</h2>
<p>A blob reference contains:</p>
<ul>
<li><code>ref</code>: CID of the blob content</li>
<li><code>mimeType</code>: MIME type (e.g., <code>image/jpeg</code>, <code>image/png</code>)</li>
<li><code>size</code>: Size in bytes</li>
</ul>
<h2 id="Using-Blobs-in-Records">Using Blobs in Records</h2>
<h3 id="Profile-Avatar">Profile Avatar</h3>
<pre><code class="language-graphql">mutation {
  updateAppBskyActorProfile(
    rkey: &quot;self&quot;
    input: {
      displayName: &quot;Alice&quot;
      avatar: {
        ref: &quot;bafkreiabc123...&quot;
        mimeType: &quot;image/jpeg&quot;
        size: 125000
      }
    }
  ) {
    displayName
    avatar {
      ref
      mimeType
      size
      url
    }
  }
}
</code></pre>
<h3 id="Profile-Banner">Profile Banner</h3>
<pre><code class="language-graphql">mutation {
  updateAppBskyActorProfile(
    rkey: &quot;self&quot;
    input: {
      displayName: &quot;Alice&quot;
      banner: {
        ref: &quot;bafkreixyz789...&quot;
        mimeType: &quot;image/jpeg&quot;
        size: 450000
      }
    }
  ) {
    displayName
    banner {
      ref
      mimeType
      size
      url
    }
  }
}
</code></pre>
<h2 id="Blob-URLs">Blob URLs</h2>
<p>Blobs automatically generate CDN URLs for serving. Use the <code>url</code> field with optional presets:</p>
<h3 id="Default-URL">Default URL</h3>
<pre><code class="language-graphql">query {
  appBskyActorProfile {
    edges {
      node {
        avatar {
          ref
          url
        }
      }
    }
  }
}
</code></pre>
<p>Returns: <code>https://cdn.bsky.app/img/feed_fullsize/plain/did:plc:.../bafkreiabc123@jpeg</code></p>
<h3 id="Avatar-Preset">Avatar Preset</h3>
<pre><code class="language-graphql">query {
  appBskyActorProfile {
    edges {
      node {
        avatar {
          ref
          url(preset: &quot;avatar&quot;)
        }
      }
    }
  }
}
</code></pre>
<p>Returns: <code>https://cdn.bsky.app/img/avatar/plain/did:plc:.../bafkreiabc123@jpeg</code></p>
<h3 id="Banner-Preset">Banner Preset</h3>
<pre><code class="language-graphql">query {
  appBskyActorProfile {
    edges {
      node {
        banner {
          url(preset: &quot;banner&quot;)
        }
      }
    }
  }
}
</code></pre>
<p>Returns: <code>https://cdn.bsky.app/img/banner/plain/did:plc:.../bafkreixyz789@jpeg</code></p>
<h2 id="Available-Presets">Available Presets</h2>
<ul>
<li><code>avatar</code> - Optimized for profile avatars (square, small)</li>
<li><code>banner</code> - Optimized for profile banners (wide, medium)</li>
<li><code>feed_thumbnail</code> - Thumbnails in feed view</li>
<li><code>feed_fullsize</code> - Full size images in feed (default)</li>
</ul>
<h2 id="Complete-Example-Update-Profile-with-Images">Complete Example: Update Profile with Images</h2>
<h3 id="Step-1-Upload-Avatar">Step 1: Upload Avatar</h3>
<pre><code class="language-graphql">mutation UploadAvatar($avatarData: String!) {
  uploadBlob(data: $avatarData, mimeType: &quot;image/jpeg&quot;) {
    ref
    mimeType
    size
  }
}
</code></pre>
<p>Variables:</p>
<pre><code class="language-json">{
  &quot;avatarData&quot;: &quot;base64EncodedJpegData...&quot;
}
</code></pre>
<p>Response:</p>
<pre><code class="language-json">{
  &quot;data&quot;: {
    &quot;uploadBlob&quot;: {
      &quot;ref&quot;: &quot;bafkreiabc123avatar&quot;,
      &quot;mimeType&quot;: &quot;image/jpeg&quot;,
      &quot;size&quot;: 125000
    }
  }
}
</code></pre>
<h3 id="Step-2-Upload-Banner">Step 2: Upload Banner</h3>
<pre><code class="language-graphql">mutation UploadBanner($bannerData: String!) {
  uploadBlob(data: $bannerData, mimeType: &quot;image/jpeg&quot;) {
    ref
    mimeType
    size
  }
}
</code></pre>
<p>Variables:</p>
<pre><code class="language-json">{
  &quot;bannerData&quot;: &quot;base64EncodedJpegData...&quot;
}
</code></pre>
<p>Response:</p>
<pre><code class="language-json">{
  &quot;data&quot;: {
    &quot;uploadBlob&quot;: {
      &quot;ref&quot;: &quot;bafkreixyz789banner&quot;,
      &quot;mimeType&quot;: &quot;image/jpeg&quot;,
      &quot;size&quot;: 450000
    }
  }
}
</code></pre>
<h3 id="Step-3-Update-Profile">Step 3: Update Profile</h3>
<pre><code class="language-graphql">mutation UpdateProfileWithImages {
  updateAppBskyActorProfile(
    rkey: &quot;self&quot;
    input: {
      displayName: &quot;Alice Smith&quot;
      description: &quot;Software engineer &amp; designer&quot;
      avatar: {
        ref: &quot;bafkreiabc123avatar&quot;
        mimeType: &quot;image/jpeg&quot;
        size: 125000
      }
      banner: {
        ref: &quot;bafkreixyz789banner&quot;
        mimeType: &quot;image/jpeg&quot;
        size: 450000
      }
    }
  ) {
    uri
    displayName
    description
    avatar {
      ref
      mimeType
      size
      url(preset: &quot;avatar&quot;)
    }
    banner {
      ref
      mimeType
      size
      url(preset: &quot;banner&quot;)
    }
  }
}
</code></pre>
<p>Response:</p>
<pre><code class="language-json">{
  &quot;data&quot;: {
    &quot;updateAppBskyActorProfile&quot;: {
      &quot;uri&quot;: &quot;at://did:plc:xyz/app.bsky.actor.profile/self&quot;,
      &quot;displayName&quot;: &quot;Alice Smith&quot;,
      &quot;description&quot;: &quot;Software engineer &amp; designer&quot;,
      &quot;avatar&quot;: {
        &quot;ref&quot;: &quot;bafkreiabc123avatar&quot;,
        &quot;mimeType&quot;: &quot;image/jpeg&quot;,
        &quot;size&quot;: 125000,
        &quot;url&quot;: &quot;https://cdn.bsky.app/img/avatar/plain/did:plc:xyz/bafkreiabc123avatar@jpeg&quot;
      },
      &quot;banner&quot;: {
        &quot;ref&quot;: &quot;bafkreixyz789banner&quot;,
        &quot;mimeType&quot;: &quot;image/jpeg&quot;,
        &quot;size&quot;: 450000,
        &quot;url&quot;: &quot;https://cdn.bsky.app/img/banner/plain/did:plc:xyz/bafkreixyz789banner@jpeg&quot;
      }
    }
  }
}
</code></pre>
<h2 id="JavaScript-Example">JavaScript Example</h2>
<pre><code class="language-javascript">// Convert file to base64
async function fileToBase64(file) {
  return new Promise((resolve, reject) =&gt; {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () =&gt; {
      const base64 = reader.result.split(',')[1]; // Remove data:image/jpeg;base64, prefix
      resolve(base64);
    };
    reader.onerror = reject;
  });
}

// Upload blob
async function uploadBlob(file, token) {
  const base64Data = await fileToBase64(file);

  const response = await fetch('/graphql', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify({
      query: `
        mutation UploadBlob($data: String!, $mimeType: String!) {
          uploadBlob(data: $data, mimeType: $mimeType) {
            ref
            mimeType
            size
          }
        }
      `,
      variables: {
        data: base64Data,
        mimeType: file.type
      }
    })
  });

  const result = await response.json();
  return result.data.uploadBlob;
}

// Usage
const avatarFile = document.getElementById('avatar-input').files[0];
const blob = await uploadBlob(avatarFile, 'your-token');
console.log('Uploaded blob:', blob.ref);
</code></pre>
</div></main></div><script src="/highlight.js"></script><script src="/mobile-nav.js"></script><script src="/minimap.js"></script></body></html>